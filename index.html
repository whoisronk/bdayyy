<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>For You, Every Day</title>
  <style>
    body {
      margin: 0;
      padding: 0;
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background-color: #ffd6e0;
      overflow-x: hidden;
      color: #3e3e3e;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: flex-start;
      min-height: 100vh;
      padding: 2rem;
      position: relative;
    }

    .background-hearts {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      z-index: -1;
      pointer-events: none;
      overflow: hidden;
    }

    .heart {
      position: absolute;
      width: 60px;
      height: 60px;
      opacity: 0.2;
      animation: float 8s ease-in-out infinite;
    }
    
    .heart svg {
      width: 100%;
      height: 100%;
      fill: #ff4d6d;
    }
    
    @keyframes float {
      0% {
        transform: translateY(0) rotate(0deg);
        opacity: 0.2;
      }
      50% {
        transform: translateY(-20px) rotate(5deg);
        opacity: 0.3;
      }
      100% {
        transform: translateY(0) rotate(0deg);
        opacity: 0.2;
      }
    }

    h1 {
      font-size: 2.5rem;
      color: #F0608B;
      text-align: center;
      text-shadow: 1px 1px 2px #ffffffaa;
      margin-bottom: 1rem;
    }

    .message-container {
      margin-top: 1rem;
      max-width: 600px;
      width: 100%;
      padding: 1.5rem;
      background: #fff;
      border-radius: 20px;
      box-shadow: 0 5px 15px rgba(0,0,0,0.1);
      text-align: center;
    }

    .message-container img {
      max-width: 100%;
      border-radius: 16px;
      margin-top: 1rem;
      box-shadow: 0 3px 10px rgba(0,0,0,0.1);
    }

    .date-heading {
      font-size: 1.25rem;
      color: #7a7a7a;
      margin-bottom: 0.5rem;
      font-weight: 600;
    }

    .navigation {
      margin-top: 1.5rem;
      display: flex;
      gap: 1rem;
    }

    .navigation button {
      background-color: #ff4d6d;
      color: white;
      border: none;
      padding: 0.5rem 1rem;
      border-radius: 8px;
      cursor: pointer;
      font-size: 1rem;
      transition: background-color 0.3s ease;
    }

    .navigation button:hover {
      background-color: #d12c2c;
    }

    .navigation button:disabled {
      background-color: #ccc;
      cursor: not-allowed;
    }

    .today-button {
      background-color: #4CAF50 !important;
    }

    .today-button:hover {
      background-color: #3e8e41 !important;
    }

    .locked-message {
      color: #888;
      font-style: italic;
      margin-top: 1rem;
    }

    .testing-controls {
      position: fixed;
      bottom: 20px;
      right: 20px;
      background: white;
      padding: 15px;
      border-radius: 10px;
      box-shadow: 0 0 15px rgba(0,0,0,0.2);
      z-index: 1000;
      border: 2px solid #ff4d6d;
    }

    .testing-controls h3 {
      margin-top: 0;
      color: #d12c2c;
    }

    .testing-controls input {
      margin: 8px 0;
      padding: 5px;
      width: 100%;
    }

    .testing-controls button {
      background-color: #ff4d6d;
      color: white;
      border: none;
      padding: 5px 10px;
      border-radius: 5px;
      cursor: pointer;
      margin: 3px 0;
      width: 100%;
    }

    #fileInputContainer {
      margin-top: 1rem;
      text-align: center;
    }

    #imageUploadBtn {
      background-color: #6c757d;
      color: white;
      border: none;
      padding: 8px 15px;
      border-radius: 5px;
      cursor: pointer;
      margin-top: 5px;
    }

    #clearImageBtn {
      background-color: #dc3545 !important;
    }

    #clearImageBtn:hover {
      background-color: #c82333 !important;
    }

    .button-group {
      display: flex;
      gap: 5px;
    }

    .button-group button {
      flex: 1;
    }

    @media (max-width: 600px) {
      h1 {
        font-size: 1.8rem;
      }
      .heart {
        width: 40px;
        height: 40px;
      }
      body {
        padding: 1rem;
      }
      .testing-controls {
        left: 20px;
        right: auto;
        width: calc(100% - 40px);
      }
    }
  </style>
</head>
<body>
  <div class="background-hearts" id="heartContainer">
    <!-- Hearts will be generated by JavaScript -->
  </div>

  <h1>KATSU KA BIRTHDAYYY!!!!!</h1>
  <div class="message-container" id="loveMessage">
    <div class="date-heading" id="dateText"></div>
    <div id="messageText">Loading your message...</div>
    <img id="imageDisplay" src="" alt="Love Image" style="display:none;" />
    <div id="futureMessage" class="locked-message" style="display:none;">
      You are early my love, wait a little more hehe. This message will unlock on <span id="unlockDate"></span>
    </div>
  </div>
  <div class="navigation">
    <button id="prevDay">← Previous</button>
    <button id="todayButton" class="today-button">Today</button>
    <button id="nextDay">Next →</button>
  </div>

  <!-- TESTING CONTROLS - REMOVE BEFORE SHARING -->
  <div class="testing-controls" id="testingPanel">
    <h3>Developer Preview</h3>
    <input type="date" id="testDateInput" min="2025-04-16" max="2025-05-02">
    <button onclick="setTestDate()">Preview This Date</button>
    <button onclick="resetDate()">Reset to Real Date</button>
    <button onclick="toggleLock()">Toggle Date Lock</button>
    
    <div style="margin-top: 15px; border-top: 1px solid #ddd; padding-top: 15px;">
      <h3>Custom Image Upload</h3>
      <input type="file" id="imageInput" accept="image/*" style="width: 100%">
      <div class="button-group">
        <button id="saveImageBtn">Save Image</button>
        <button id="clearImageBtn">Clear Image</button>
      </div>
      <div id="imageStatus" style="margin-top: 5px; font-size: 0.9em; color: #666;"></div>
    </div>
    
    <div id="testingStatus">System Date: ON</div>
  </div>

  <script>
    // ======================
    // TESTING CONFIGURATION
    // ======================
    let testingMode = true; // Set to false when sharing
    let enforceDateLock = false; // When true, ignores system date changes
    let forcedDate = null;
    let today = new Date();

    // ======================
    // MESSAGE DATA
    // ======================
    const messages = {
      "2025-04-16": {
        text: "Your smile on a tired day is always my favorite thing.",
        img: ""
      },
      "2025-04-17": {
        text: "When you laugh, my heart flutters and i feel only bliss.",
        img: ""
      },
      "2025-04-18": {
        text: "Your kindness and the way you care makes you glow brighter than fireflies on the darkest night.",
        img: ""
      },
      "2025-04-19": {
        text: "The way you see the good in everything inspires me and changes me.",
        img: ""
      },
      "2025-04-20": {
        text: "You make the most ordinary moments feel magical, even the silence between us is never empty and always filled with love.",
        img: ""
      },
      "2025-04-21": {
        text: "Your strength and determination amazes me every single day",
        img: ""
      },
      "2025-04-22": {
        text: "I fall in love with you a little more each and every morning, and every morning is the best when it's with you.",
        img: ""
      },
      "2025-04-23": {
        text: "You are my favourite place in this world, my home.",
        img: ""
      },
      "2025-04-24": {
        text: "You make my heart skip a beat without even trying.",
        img: ""
      },
      "2025-04-25": {
        text: "Your voice is my favorite sound in the whole world.",
        img: ""
      },
      "2025-04-26": {
        text: "I love how you make everything seem miles better just by being yourself.",
        img: ""
      },
      "2025-04-27": {
        text: "Your love is the greatest gift I've ever received.",
        img: ""
      },
      "2025-04-28": {
        text: "Every day with you brings me joy and every thought of mine has you in it. I love it. ",
        img: ""
      },
      "2025-04-29": {
        text: "You're my happy thought when things get tough.",
        img: ""
      },
      "2025-04-30": {
        text: "I love how we can be silly together without judgment, you are my safe space my love.",
        img: ""
      },
      "2025-05-01": {
        text: "Just one more day until your special day, my sunshinee!! I love youuu and i'm so so so proud of you.",
        img: ""
      },
      "2025-05-02": {
        text: "Happy Birthday, my love. I hope I made you feel even a bit of what you mean to me.",
        img: ""
      }
    };

    // ======================
    // LOCAL STORAGE FUNCTIONS
    // ======================
    function getImageKey(dateStr) {
      return `image_${dateStr}`;
    }
    
    // Load saved images from local storage
    function loadSavedImages() {
      for (const date in messages) {
        const savedImage = localStorage.getItem(getImageKey(date));
        if (savedImage) {
          messages[date].img = savedImage;
        } else if (!messages[date].img) {
          // Set default image if no saved image
          messages[date].img = `https://source.unsplash.com/random/600x400/?love,${date}`;
        }
      }
    }

    function saveImage(dateStr, imageData) {
      localStorage.setItem(getImageKey(dateStr), imageData);
      messages[dateStr].img = imageData;
    }

    function clearImage(dateStr) {
      localStorage.removeItem(getImageKey(dateStr));
      messages[dateStr].img = `https://source.unsplash.com/random/600x400/?love,${dateStr}`;
    }
    
    loadSavedImages();

    // ======================
    // HEART BACKGROUND
    // ======================
    function createHearts() {
      const heartContainer = document.getElementById('heartContainer');
      const viewportWidth = window.innerWidth;
      const viewportHeight = window.innerHeight;
      
      // Clear existing hearts
      heartContainer.innerHTML = '';
      
      // Create 20 hearts with random positions
      for (let i = 0; i < 20; i++) {
        const heart = document.createElement('div');
        heart.className = 'heart';
        
        // Random position ensuring hearts don't get cut off
        const left = Math.random() * (viewportWidth - 80);
        const top = Math.random() * (viewportHeight - 80);
        
        heart.style.left = `${left}px`;
        heart.style.top = `${top}px`;
        
        // Random size between 30px and 70px
        const size = 30 + Math.random() * 40;
        heart.style.width = `${size}px`;
        heart.style.height = `${size}px`;
        
        // Random animation duration and delay
        heart.style.animationDuration = `${6 + Math.random() * 4}s`;
        heart.style.animationDelay = `${Math.random() * 5}s`;
        
        // Add SVG heart
        heart.innerHTML = `
          <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
            <path d="M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 
              2 5.42 4.42 3 7.5 3c1.74 0 3.41 0.81 4.5 2.09 
              C13.09 3.81 14.76 3 16.5 3 
              19.58 3 22 5.42 22 8.5 
              c0 3.78-3.4 6.86-8.55 11.54L12 21.35z"/>
          </svg>
        `;
        
        heartContainer.appendChild(heart);
      }
    }

    // Create hearts and recreate when window is resized
    createHearts();
    window.addEventListener('resize', createHearts);

    // ======================
    // CORE FUNCTIONALITY
    // ======================
    const dateText = document.getElementById('dateText');
    const messageText = document.getElementById('messageText');
    const imageDisplay = document.getElementById('imageDisplay');
    const prevButton = document.getElementById('prevDay');
    const nextButton = document.getElementById('nextDay');
    const todayButton = document.getElementById('todayButton');
    const futureMessage = document.getElementById('futureMessage');
    const unlockDate = document.getElementById('unlockDate');
    const testingStatus = document.getElementById('testingStatus');
    const imageStatus = document.getElementById('imageStatus');

    function getCurrentDate() {
      if (testingMode && forcedDate) {
        return forcedDate;
      }
      return new Date();
    }

    function updateMessage(date) {
      const currentDate = getCurrentDate();
      const dateStr = date.toISOString().split('T')[0];
      const currentDateStr = currentDate.toISOString().split('T')[0];
      
      // Save the current date to localStorage
      localStorage.setItem('lastViewedDate', date.toISOString());
      
      // Update the displayed date
      dateText.innerText = date.toDateString();
      
      // Check if this date is in the future (and lock is enforced)
      if (enforceDateLock && dateStr > currentDateStr) {
        messageText.style.display = 'none';
        imageDisplay.style.display = 'none';
        futureMessage.style.display = 'block';
        unlockDate.innerText = dateStr;
      } 
      // Check if we have a message for this date
      else if (messages[dateStr]) {
        messageText.style.display = 'block';
        messageText.innerText = messages[dateStr].text;
        
        if (messages[dateStr].img) {
          imageDisplay.src = messages[dateStr].img;
          imageDisplay.style.display = 'block';
        } else {
          imageDisplay.style.display = 'none';
        }
        
        futureMessage.style.display = 'none';
      } else if (date < new Date('2025-04-16')) {
        messageText.style.display = 'block';
        messageText.innerText = "The countdown begins on April 16th";
        imageDisplay.style.display = 'none';
        futureMessage.style.display = 'none';
      } else {
        messageText.style.display = 'block';
        messageText.innerText = "Looking forward to seeing you soon!";
        imageDisplay.style.display = 'none';
        futureMessage.style.display = 'none';
      }
      
      // Update button states
      updateButtonStates(date);
      
      // Update image status text
      updateImageStatus(dateStr);
    }

    function updateButtonStates(date) {
      const isToday = date.toDateString() === getCurrentDate().toDateString();
      todayButton.disabled = isToday;
      prevButton.disabled = date <= new Date('2025-04-16');
      nextButton.disabled = date >= new Date('2025-05-02');
    }
    
    function updateImageStatus(dateStr) {
      const hasCustomImage = localStorage.getItem(getImageKey(dateStr)) !== null;
      
      if (hasCustomImage) {
        imageStatus.textContent = "✓ Custom image is set for this date";
        imageStatus.style.color = "#28a745";
      } else {
        imageStatus.textContent = "No custom image set (using default)";
        imageStatus.style.color = "#666";
      }
    }

    // ======================
    // IMAGE HANDLING
    // ======================
    document.getElementById('saveImageBtn').addEventListener('click', function() {
      const imageInput = document.getElementById('imageInput');
      if (imageInput.files && imageInput.files[0]) {
        const reader = new FileReader();
        const dateStr = today.toISOString().split('T')[0];
        
        reader.onload = function(e) {
          // Save image to localStorage
          saveImage(dateStr, e.target.result);
          
          // Update the display
          updateMessage(today);
          
          // Show confirmation
          alert(`Image saved for ${dateStr}!`);
        };
        
        reader.readAsDataURL(imageInput.files[0]);
      } else {
        alert('Please select an image first');
      }
    });
    
    // NEW: Clear Image Button
    document.getElementById('clearImageBtn').addEventListener('click', function() {
      const dateStr = today.toISOString().split('T')[0];
      
      // Check if there's a custom image to clear
      if (localStorage.getItem(getImageKey(dateStr))) {
        // Confirm before removing
        if (confirm(`Are you sure you want to remove the image for ${dateStr}?`)) {
          clearImage(dateStr);
          updateMessage(today);
          alert(`Image cleared for ${dateStr}`);
        }
      } else {
        alert('No custom image to clear for this date');
      }
    });

    // ======================
    // TESTING FUNCTIONS
    // ======================
    function setTestDate() {
      const dateStr = document.getElementById('testDateInput').value;
      forcedDate = new Date(dateStr);
      today = forcedDate;
      updateMessage(today);
      testingStatus.textContent = `Previewing: ${dateStr}`;
    }

    function resetDate() {
      forcedDate = null;
      today = new Date();
      updateMessage(today);
      testingStatus.textContent = "Using system date";
    }

    function toggleLock() {
      enforceDateLock = !enforceDateLock;
      testingStatus.textContent = enforceDateLock 
        ? "Date Lock: ON (system date ignored)" 
        : "Date Lock: OFF (using preview date)";
      updateMessage(today);
    }

    // ======================
    // EVENT LISTENERS
    // ======================
    prevButton.addEventListener('click', () => {
      const prevDate = new Date(today);
      prevDate.setDate(prevDate.getDate() - 1);
      today = prevDate;
      updateMessage(today);
    });

    nextButton.addEventListener('click', () => {
      const nextDate = new Date(today);
      nextDate.setDate(nextDate.getDate() + 1);
      today = nextDate;
      updateMessage(today);
    });

    todayButton.addEventListener('click', () => {
      today = getCurrentDate();
      updateMessage(today);
    });

    // ======================
    // INITIALIZE
    // ======================
    // Set initial date and display message
    updateMessage(today);

    // Export feature - allows downloading the page with embedded images
    function addExportOption() {
      const exportBtn = document.createElement('button');
      exportBtn.innerText = 'Export Page for Sharing';
      exportBtn.style.backgroundColor = '#6610f2';
      exportBtn.style.marginTop = '10px';
      
      exportBtn.addEventListener('click', function() {
        // Set testingMode to false before export
        const originalTestingMode = testingMode;
        testingMode = false;
        
        // Hide testing panel
        document.getElementById('testingPanel').style.display = 'none';
        
        // Create downloadable HTML
        const htmlContent = document.documentElement.outerHTML;
        
        // Create download link
        const element = document.createElement('a');
        element.setAttribute('href', 'data:text/html;charset=utf-8,' + encodeURIComponent(htmlContent));
        element.setAttribute('download', 'birthday_countdown.html');
        
        element.style.display = 'none';
        document.body.appendChild(element);
        element.click();
        document.body.removeChild(element);
        
        // Show testing panel again
        setTimeout(() => {
          document.getElementById('testingPanel').style.display = 'block';
          testingMode = originalTestingMode;
        }, 100);
      });
      
      document.querySelector('.testing-controls').appendChild(exportBtn);
    }
    
    addExportOption();
  </script>
</body>
</html>
